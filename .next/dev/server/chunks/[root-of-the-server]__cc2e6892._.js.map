{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/djtru/Documents/GitHub/SoCal-Coast-Interior-Pressure-Gradient-Tracker/lib/api/open-meteo.ts"],"sourcesContent":["import { Location, PressureReading } from \"@/types/location\";\r\n\r\nexport interface OpenMeteoResponse {\r\n  latitude: number;\r\n  longitude: number;\r\n  generationtime_ms: number;\r\n  utc_offset_seconds: number;\r\n  timezone: string;\r\n  timezone_abbreviation: string;\r\n  elevation: number;\r\n  hourly_units: {\r\n    time: string;\r\n    pressure_msl: string;\r\n    temperature_2m?: string;\r\n  };\r\n  hourly: {\r\n    time: string[];\r\n    pressure_msl: number[];\r\n    temperature_2m?: number[];\r\n  };\r\n}\r\n\r\n/**\r\n * Fetch current MSLP data for a single location from Open-Meteo API\r\n */\r\nexport async function fetchMSLPForLocation(\r\n  location: Location\r\n): Promise<PressureReading> {\r\n  const url = new URL(\"https://api.open-meteo.com/v1/forecast\");\r\n  url.searchParams.append(\"latitude\", location.latitude.toString());\r\n  url.searchParams.append(\"longitude\", location.longitude.toString());\r\n  url.searchParams.append(\"hourly\", \"pressure_msl,temperature_2m\");\r\n  url.searchParams.append(\"forecast_days\", \"1\");\r\n  url.searchParams.append(\"timezone\", \"America/Los_Angeles\");\r\n\r\n  const response = await fetch(url.toString(), {\r\n    next: { revalidate: 3600 }, // Cache for 1 hour\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw new Error(\r\n      `Failed to fetch MSLP data for ${location.name}: ${response.statusText}`\r\n    );\r\n  }\r\n\r\n  const data: OpenMeteoResponse = await response.json();\r\n\r\n  // Find the index for the current hour\r\n  // The API returns times in the timezone we specified (America/Los_Angeles)\r\n  const now = new Date();\r\n  const nowTimestamp = now.getTime();\r\n  \r\n  // Find the most recent hour that is not in the future\r\n  let currentIndex = 0;\r\n  for (let i = 0; i < data.hourly.time.length; i++) {\r\n    const apiTime = new Date(data.hourly.time[i]).getTime();\r\n    if (apiTime <= nowTimestamp) {\r\n      currentIndex = i;\r\n    } else {\r\n      break;\r\n    }\r\n  }\r\n  \r\n  const timestamp = data.hourly.time[currentIndex];\r\n  const pressure = data.hourly.pressure_msl[currentIndex];\r\n  const temperature = data.hourly.temperature_2m?.[currentIndex];\r\n\r\n  return {\r\n    locationId: location.id,\r\n    timestamp,\r\n    pressure,\r\n    temperature,\r\n  };\r\n}\r\n\r\n/**\r\n * Fetch MSLP data for multiple locations in parallel\r\n */\r\nexport async function fetchMSLPForLocations(\r\n  locations: Location[]\r\n): Promise<PressureReading[]> {\r\n  const promises = locations.map((location) =>\r\n    fetchMSLPForLocation(location)\r\n  );\r\n  return Promise.all(promises);\r\n}\r\n\r\n/**\r\n * Fetch historical MSLP data for a location\r\n */\r\nexport async function fetchHistoricalMSLP(\r\n  location: Location,\r\n  startDate: string,\r\n  endDate: string\r\n): Promise<{ time: string[]; pressure: number[] }> {\r\n  const url = new URL(\"https://archive-api.open-meteo.com/v1/archive\");\r\n  url.searchParams.append(\"latitude\", location.latitude.toString());\r\n  url.searchParams.append(\"longitude\", location.longitude.toString());\r\n  url.searchParams.append(\"start_date\", startDate);\r\n  url.searchParams.append(\"end_date\", endDate);\r\n  url.searchParams.append(\"hourly\", \"pressure_msl\");\r\n  url.searchParams.append(\"timezone\", \"America/Los_Angeles\");\r\n\r\n  const response = await fetch(url.toString(), {\r\n    next: { revalidate: 86400 }, // Cache for 24 hours\r\n  });\r\n\r\n  if (!response.ok) {\r\n    throw new Error(\r\n      `Failed to fetch historical data for ${location.name}: ${response.statusText}`\r\n    );\r\n  }\r\n\r\n  const data: OpenMeteoResponse = await response.json();\r\n\r\n  return {\r\n    time: data.hourly.time,\r\n    pressure: data.hourly.pressure_msl,\r\n  };\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAyBO,eAAe,qBACpB,QAAkB;IAElB,MAAM,MAAM,IAAI,IAAI;IACpB,IAAI,YAAY,CAAC,MAAM,CAAC,YAAY,SAAS,QAAQ,CAAC,QAAQ;IAC9D,IAAI,YAAY,CAAC,MAAM,CAAC,aAAa,SAAS,SAAS,CAAC,QAAQ;IAChE,IAAI,YAAY,CAAC,MAAM,CAAC,UAAU;IAClC,IAAI,YAAY,CAAC,MAAM,CAAC,iBAAiB;IACzC,IAAI,YAAY,CAAC,MAAM,CAAC,YAAY;IAEpC,MAAM,WAAW,MAAM,MAAM,IAAI,QAAQ,IAAI;QAC3C,MAAM;YAAE,YAAY;QAAK;IAC3B;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MACR,CAAC,8BAA8B,EAAE,SAAS,IAAI,CAAC,EAAE,EAAE,SAAS,UAAU,EAAE;IAE5E;IAEA,MAAM,OAA0B,MAAM,SAAS,IAAI;IAEnD,sCAAsC;IACtC,2EAA2E;IAC3E,MAAM,MAAM,IAAI;IAChB,MAAM,eAAe,IAAI,OAAO;IAEhC,sDAAsD;IACtD,IAAI,eAAe;IACnB,IAAK,IAAI,IAAI,GAAG,IAAI,KAAK,MAAM,CAAC,IAAI,CAAC,MAAM,EAAE,IAAK;QAChD,MAAM,UAAU,IAAI,KAAK,KAAK,MAAM,CAAC,IAAI,CAAC,EAAE,EAAE,OAAO;QACrD,IAAI,WAAW,cAAc;YAC3B,eAAe;QACjB,OAAO;YACL;QACF;IACF;IAEA,MAAM,YAAY,KAAK,MAAM,CAAC,IAAI,CAAC,aAAa;IAChD,MAAM,WAAW,KAAK,MAAM,CAAC,YAAY,CAAC,aAAa;IACvD,MAAM,cAAc,KAAK,MAAM,CAAC,cAAc,EAAE,CAAC,aAAa;IAE9D,OAAO;QACL,YAAY,SAAS,EAAE;QACvB;QACA;QACA;IACF;AACF;AAKO,eAAe,sBACpB,SAAqB;IAErB,MAAM,WAAW,UAAU,GAAG,CAAC,CAAC,WAC9B,qBAAqB;IAEvB,OAAO,QAAQ,GAAG,CAAC;AACrB;AAKO,eAAe,oBACpB,QAAkB,EAClB,SAAiB,EACjB,OAAe;IAEf,MAAM,MAAM,IAAI,IAAI;IACpB,IAAI,YAAY,CAAC,MAAM,CAAC,YAAY,SAAS,QAAQ,CAAC,QAAQ;IAC9D,IAAI,YAAY,CAAC,MAAM,CAAC,aAAa,SAAS,SAAS,CAAC,QAAQ;IAChE,IAAI,YAAY,CAAC,MAAM,CAAC,cAAc;IACtC,IAAI,YAAY,CAAC,MAAM,CAAC,YAAY;IACpC,IAAI,YAAY,CAAC,MAAM,CAAC,UAAU;IAClC,IAAI,YAAY,CAAC,MAAM,CAAC,YAAY;IAEpC,MAAM,WAAW,MAAM,MAAM,IAAI,QAAQ,IAAI;QAC3C,MAAM;YAAE,YAAY;QAAM;IAC5B;IAEA,IAAI,CAAC,SAAS,EAAE,EAAE;QAChB,MAAM,IAAI,MACR,CAAC,oCAAoC,EAAE,SAAS,IAAI,CAAC,EAAE,EAAE,SAAS,UAAU,EAAE;IAElF;IAEA,MAAM,OAA0B,MAAM,SAAS,IAAI;IAEnD,OAAO;QACL,MAAM,KAAK,MAAM,CAAC,IAAI;QACtB,UAAU,KAAK,MAAM,CAAC,YAAY;IACpC;AACF"}},
    {"offset": {"line": 123, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/data/locations.json"],"sourcesContent":["{\"locations\":[{\"id\":\"sna\",\"name\":\"Santa Ana\",\"code\":\"SNA\",\"latitude\":33.6762,\"longitude\":-117.8681,\"type\":\"coast\",\"elevation\":17},{\"id\":\"sba\",\"name\":\"Santa Barbara\",\"code\":\"SBA\",\"latitude\":34.4264,\"longitude\":-119.8403,\"type\":\"coast\",\"elevation\":3},{\"id\":\"smx\",\"name\":\"Santa Maria\",\"code\":\"SMX\",\"latitude\":34.8989,\"longitude\":-120.4573,\"type\":\"coast\",\"elevation\":73},{\"id\":\"dag\",\"name\":\"Barstow\",\"code\":\"DAG\",\"latitude\":34.8542,\"longitude\":-116.7866,\"type\":\"interior\",\"elevation\":585},{\"id\":\"las\",\"name\":\"Las Vegas\",\"code\":\"LAS\",\"latitude\":36.084,\"longitude\":-115.1537,\"type\":\"interior\",\"elevation\":664},{\"id\":\"lax\",\"name\":\"Los Angeles (LAX)\",\"code\":\"LAX\",\"latitude\":33.9416,\"longitude\":-118.4085,\"type\":\"coast\",\"elevation\":38},{\"id\":\"bur\",\"name\":\"Burbank\",\"code\":\"BUR\",\"latitude\":34.2006,\"longitude\":-118.359,\"type\":\"interior\",\"elevation\":236},{\"id\":\"ont\",\"name\":\"Ontario\",\"code\":\"ONT\",\"latitude\":34.056,\"longitude\":-117.6012,\"type\":\"interior\",\"elevation\":287},{\"id\":\"psp\",\"name\":\"Palm Springs\",\"code\":\"PSP\",\"latitude\":33.8297,\"longitude\":-116.5067,\"type\":\"interior\",\"elevation\":145},{\"id\":\"san\",\"name\":\"San Diego\",\"code\":\"SAN\",\"latitude\":32.7338,\"longitude\":-117.1933,\"type\":\"coast\",\"elevation\":9},{\"id\":\"crq\",\"name\":\"Carlsbad\",\"code\":\"CRQ\",\"latitude\":33.1283,\"longitude\":-117.28,\"type\":\"coast\",\"elevation\":100},{\"id\":\"smo\",\"name\":\"Santa Monica\",\"code\":\"SMO\",\"latitude\":34.0158,\"longitude\":-118.4513,\"type\":\"coast\",\"elevation\":53},{\"id\":\"vnr\",\"name\":\"Van Nuys\",\"code\":\"VNR\",\"latitude\":34.2098,\"longitude\":-118.4897,\"type\":\"interior\",\"elevation\":244},{\"id\":\"oxr\",\"name\":\"Oxnard\",\"code\":\"OXR\",\"latitude\":34.2008,\"longitude\":-119.207,\"type\":\"coast\",\"elevation\":13},{\"id\":\"bfl\",\"name\":\"Bakersfield\",\"code\":\"BFL\",\"latitude\":35.4336,\"longitude\":-119.0568,\"type\":\"interior\",\"elevation\":150},{\"id\":\"sbp\",\"name\":\"San Luis Obispo\",\"code\":\"SBP\",\"latitude\":35.2368,\"longitude\":-120.6424,\"type\":\"coast\",\"elevation\":65},{\"id\":\"vis\",\"name\":\"Visalia\",\"code\":\"VIS\",\"latitude\":36.3186,\"longitude\":-119.393,\"type\":\"interior\",\"elevation\":90},{\"id\":\"ipx\",\"name\":\"Indio/Thermal\",\"code\":\"IPX\",\"latitude\":33.6269,\"longitude\":-116.16,\"type\":\"interior\",\"elevation\":-22},{\"id\":\"lbb\",\"name\":\"Long Beach\",\"code\":\"LBB\",\"latitude\":33.8176,\"longitude\":-118.1516,\"type\":\"coast\",\"elevation\":18},{\"id\":\"riv\",\"name\":\"Riverside\",\"code\":\"RIV\",\"latitude\":33.9519,\"longitude\":-117.3962,\"type\":\"interior\",\"elevation\":253},{\"id\":\"sbd\",\"name\":\"San Bernardino\",\"code\":\"SBD\",\"latitude\":34.0953,\"longitude\":-117.2352,\"type\":\"interior\",\"elevation\":348},{\"id\":\"mry\",\"name\":\"Monterey\",\"code\":\"MRY\",\"latitude\":36.5874,\"longitude\":-121.843,\"type\":\"coast\",\"elevation\":78},{\"id\":\"sjc\",\"name\":\"San Jose\",\"code\":\"SJC\",\"latitude\":37.3639,\"longitude\":-121.9289,\"type\":\"interior\",\"elevation\":18},{\"id\":\"yum\",\"name\":\"Yuma\",\"code\":\"YUM\",\"latitude\":32.6566,\"longitude\":-114.606,\"type\":\"interior\",\"elevation\":65}],\"homeLocationId\":\"sna\",\"dashboardLocationIds\":[\"dag\",\"las\"]}"],"names":[],"mappings":"AAAA"}},
    {"offset": {"line": 123, "column": 2940}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 127, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/djtru/Documents/GitHub/SoCal-Coast-Interior-Pressure-Gradient-Tracker/app/api/pressure/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from \"next/server\";\r\nimport { fetchMSLPForLocations } from \"@/lib/api/open-meteo\";\r\nimport locationsData from \"@/data/locations.json\";\r\nimport { Location } from \"@/types/location\";\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const searchParams = request.nextUrl.searchParams;\r\n    const locationIds = searchParams.get(\"ids\")?.split(\",\") || [];\r\n\r\n    if (locationIds.length === 0) {\r\n      return NextResponse.json(\r\n        { error: \"No location IDs provided\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const locations = locationsData.locations as Location[];\r\n    const requestedLocations = locationIds\r\n      .map((id) => locations.find((loc) => loc.id === id))\r\n      .filter(Boolean) as Location[];\r\n\r\n    if (requestedLocations.length === 0) {\r\n      return NextResponse.json(\r\n        { error: \"No valid locations found\" },\r\n        { status: 404 }\r\n      );\r\n    }\r\n\r\n    const pressureReadings = await fetchMSLPForLocations(requestedLocations);\r\n\r\n    return NextResponse.json({\r\n      success: true,\r\n      data: pressureReadings,\r\n      timestamp: new Date().toISOString(),\r\n    });\r\n  } catch (error) {\r\n    console.error(\"Error fetching pressure data:\", error);\r\n    return NextResponse.json(\r\n      {\r\n        error: \"Failed to fetch pressure data\",\r\n        details: error instanceof Error ? error.message : \"Unknown error\",\r\n      },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\nexport const revalidate = 3600; // Cache for 1 hour\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAGO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,eAAe,QAAQ,OAAO,CAAC,YAAY;QACjD,MAAM,cAAc,aAAa,GAAG,CAAC,QAAQ,MAAM,QAAQ,EAAE;QAE7D,IAAI,YAAY,MAAM,KAAK,GAAG;YAC5B,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA2B,GACpC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,YAAY,oGAAa,CAAC,SAAS;QACzC,MAAM,qBAAqB,YACxB,GAAG,CAAC,CAAC,KAAO,UAAU,IAAI,CAAC,CAAC,MAAQ,IAAI,EAAE,KAAK,KAC/C,MAAM,CAAC;QAEV,IAAI,mBAAmB,MAAM,KAAK,GAAG;YACnC,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA2B,GACpC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,mBAAmB,MAAM,IAAA,sJAAqB,EAAC;QAErD,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,SAAS;YACT,MAAM;YACN,WAAW,IAAI,OAAO,WAAW;QACnC;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,iBAAiB,QAAQ,MAAM,OAAO,GAAG;QACpD,GACA;YAAE,QAAQ;QAAI;IAElB;AACF;AAEO,MAAM,aAAa,MAAM,mBAAmB"}}]
}